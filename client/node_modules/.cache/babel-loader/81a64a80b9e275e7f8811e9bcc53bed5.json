{"ast":null,"code":"import _toConsumableArray from\"/Users/albertqi/Desktop/Directory/CampusContact/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/albertqi/Desktop/Directory/CampusContact/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _defineProperty from\"/Users/albertqi/Desktop/Directory/CampusContact/client/node_modules/@babel/runtime/helpers/esm/defineProperty.js\";import _objectSpread from\"/Users/albertqi/Desktop/Directory/CampusContact/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/albertqi/Desktop/Directory/CampusContact/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/albertqi/Desktop/Directory/CampusContact/client/node_modules/@babel/runtime/regenerator/index.js\";import{React}from\"react\";import{useState,useEffect}from\"react\";import{useNavigate,Link,useLocation}from\"react-router-dom\";import Tag from\"../components/Tag\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditScript(){var navigate=useNavigate();var initialScript=useLocation().state;var _useState=useState(_objectSpread(_objectSpread({},initialScript),{},{timeline:initialScript.timeline.slice(0,initialScript.timeline.indexOf('T'))})),_useState2=_slicedToArray(_useState,2),script=_useState2[0],setScript=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),tagsInput=_useState4[0],setTagsInput=_useState4[1];var _useState5=useState(initialScript.tags),_useState6=_slicedToArray(_useState5,2),tags=_useState6[0],setTags=_useState6[1];var fieldNames=[\"First Name\",\"Last Name\",\"House\",\"Suite\",\"Class Year\",\"City\",\"State\",\"Contact Status\",\"PTV Status\",\"Registration Status\",\"Stage of Voting Process\"];var fieldValues=[\"{first_name}\",\"{last_name}\",\"{house}\",\"{suite}\",\"{class_year}\",\"{city}\",\"{state}\",\"{contact_status}\",\"{ptv_status}\",\"{registration_status}\",\"{stage_of_voting_process}\"];// Update script state on input change\nvar inputChange=function inputChange(e){var _e$target=e.target,name=_e$target.name,value=_e$target.value;setScript(_objectSpread(_objectSpread({},script),{},_defineProperty({},name,value)));};// Handle field\nvar handleField=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var name,scriptElement,start,end,value,update;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:name=e.target.innerHTML;scriptElement=document.getElementById(\"scriptBody\");start=scriptElement.selectionStart,end=scriptElement.selectionEnd;value=fieldValues[fieldNames.indexOf(name)];update=script.body.slice(0,start)+value+script.body.slice(end);_context.next=7;return setScript(_objectSpread(_objectSpread({},script),{},{body:update}));case 7:updateCaret(end+value.length);case 8:case\"end\":return _context.stop();}}},_callee);}));return function handleField(_x){return _ref.apply(this,arguments);};}();// Update caret position\nvar updateCaret=function updateCaret(i){var scriptElement=document.getElementById(\"scriptBody\");scriptElement.focus();scriptElement.setSelectionRange(i,i);};// Handle tags input change\nvar tagsInputChange=function tagsInputChange(e){var value=e.target.value;setTagsInput(value);};// Handle enter key on tags\nvar handleKeyDown=function handleKeyDown(e){if(e.key==='Enter'){var value=e.target.value;if(!tags.includes(value)&&value.length>0){setTags([].concat(_toConsumableArray(tags),[value]));setTagsInput(\"\");}}};// Delete tag\nvar deleteTag=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setTags(tags.filter(function(tag){return tag!==value;}));case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function deleteTag(_x2){return _ref2.apply(this,arguments);};}();// Form validation\nvar validate=function validate(){var required=[script.title,script.description,script.timeline,script.body];for(var _i=0,_required=required;_i<_required.length;_i++){var i=_required[_i];if(i==null||i.length<1)return false;}return true;};// Create script\nvar onSubmit=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:e.preventDefault();if(validate()){_context3.next=3;break;}return _context3.abrupt(\"return\");case 3:_context3.prev=3;_context3.next=6;return fetch(\"http://localhost:8000/scripts/edit/\".concat(script.id),{method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(script)});case 6:response=_context3.sent;navigate(\"/scripts\");_context3.next=13;break;case 10:_context3.prev=10;_context3.t0=_context3[\"catch\"](3);console.error(_context3.t0.message);case 13:case\"end\":return _context3.stop();}}},_callee3,null,[[3,10]]);}));return function onSubmit(_x3){return _ref3.apply(this,arguments);};}();useEffect(function(){setScript(_objectSpread(_objectSpread({},script),{},{tags:tags}));},[tags]);return/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"div\",{className:\"m-6 mb-0 bg-white rounded-lg border dark:border-gray-700 dark:bg-gray-800\",children:/*#__PURE__*/_jsx(\"h5\",{className:\"m-3 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white\",children:\"Edit Script\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\",children:\"Title\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"title\",value:script.title||\"\",onChange:inputChange,className:\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\",children:\"Description\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"description\",value:script.description||\"\",onChange:inputChange,className:\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\",children:\"Timeline\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"timeline\",value:script.timeline||\"\",onChange:inputChange,className:\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-4\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\",children:\"Tags (optional)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"tags\",value:tagsInput||\"\",onChange:tagsInputChange,onKeyDown:handleKeyDown,className:\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\",required:true}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-2 text-sm text-gray-500 dark:text-gray-400\",children:\"Click 'Enter' to add tags.\"}),tags.map(function(tag){return/*#__PURE__*/_jsx(Tag,{value:tag,onDelete:deleteTag},tag);})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400\",children:\"Script\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"scriptBody\",type:\"text\",name:\"body\",value:script.body,onChange:inputChange,rows:4,className:\"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\",placeholder:\"Write your script here...\",required:true})]}),fieldNames.map(function(field){return/*#__PURE__*/_jsx(\"button\",{onClick:handleField,type:\"button\",className:\"mt-2 mr-2 inline-flex items-center bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm font-medium px-1.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800 dark:hover:bg-blue-300\",children:field},field);})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pl-6 pb-6\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:onSubmit,className:\"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800\",children:\"Save\"}),/*#__PURE__*/_jsx(Link,{to:\"/scripts\",children:/*#__PURE__*/_jsx(\"button\",{type:\"reset\",className:\"absolute right-6 text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900\",children:\"Cancel\"})})]})]});}export default EditScript;","map":{"version":3,"sources":["/Users/albertqi/Desktop/Directory/CampusContact/client/src/pages/EditScript.js"],"names":["React","useState","useEffect","useNavigate","Link","useLocation","Tag","EditScript","navigate","initialScript","state","timeline","slice","indexOf","script","setScript","tagsInput","setTagsInput","tags","setTags","fieldNames","fieldValues","inputChange","e","target","name","value","handleField","innerHTML","scriptElement","document","getElementById","start","selectionStart","end","selectionEnd","update","body","updateCaret","length","i","focus","setSelectionRange","tagsInputChange","handleKeyDown","key","includes","deleteTag","filter","tag","validate","required","title","description","onSubmit","preventDefault","fetch","id","method","headers","JSON","stringify","response","console","error","message","map","field"],"mappings":"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","sourcesContent":["import { React } from \"react\";\nimport { useState, useEffect } from \"react\";\nimport { useNavigate, Link, useLocation } from \"react-router-dom\";\nimport Tag from \"../components/Tag\";\n\nfunction EditScript() {\n    const navigate = useNavigate();\n    const initialScript = useLocation().state;\n\n    const [script, setScript] = useState({\n        ...initialScript,\n        timeline: initialScript.timeline.slice(0, initialScript.timeline.indexOf('T'))\n    });\n    const [tagsInput, setTagsInput] = useState(\"\");\n    const [tags, setTags] = useState(initialScript.tags);\n\n    const fieldNames = [\"First Name\", \"Last Name\", \"House\", \"Suite\", \"Class Year\",\n        \"City\", \"State\", \"Contact Status\", \"PTV Status\", \"Registration Status\", \"Stage of Voting Process\"];\n    const fieldValues = [\"{first_name}\", \"{last_name}\", \"{house}\", \"{suite}\", \"{class_year}\",\n        \"{city}\", \"{state}\", \"{contact_status}\", \"{ptv_status}\", \"{registration_status}\", \"{stage_of_voting_process}\"];\n\n    // Update script state on input change\n    const inputChange = (e) => {\n        const { name, value } = e.target;\n        setScript({\n            ...script,\n            [name]: value,\n        });\n    };\n\n    // Handle field\n    const handleField = async (e) => {\n        const name = e.target.innerHTML;\n        const scriptElement = document.getElementById(\"scriptBody\");\n        const start = scriptElement.selectionStart, end = scriptElement.selectionEnd;\n        const value = fieldValues[fieldNames.indexOf(name)];\n\n        const update = script.body.slice(0, start) + value + script.body.slice(end);\n\n        await setScript({\n            ...script,\n            body: update,\n        });\n\n        updateCaret(end + value.length);\n    };\n\n    // Update caret position\n    const updateCaret = (i) => {\n        const scriptElement = document.getElementById(\"scriptBody\");\n        scriptElement.focus();\n        scriptElement.setSelectionRange(i, i);\n    };\n\n    // Handle tags input change\n    const tagsInputChange = (e) => {\n        const { value } = e.target;\n        setTagsInput(value);\n    };\n\n    // Handle enter key on tags\n    const handleKeyDown = (e) => {\n        if (e.key === 'Enter') {\n            const { value } = e.target;\n            if (!tags.includes(value) && value.length > 0) {\n                setTags([\n                    ...tags, value\n                ]);\n                setTagsInput(\"\");\n            }\n        }\n    };\n\n    // Delete tag\n    const deleteTag = async (value) => {\n        setTags(tags.filter(tag => tag !== value));\n    };\n\n    // Form validation\n    const validate = () => {\n        let required = [script.title, script.description, script.timeline, script.body];\n        for (const i of required) {\n            if (i == null || i.length < 1) return false;\n        }\n        return true;\n    };\n\n    // Create script\n    const onSubmit = async (e) => {\n        e.preventDefault();\n        if (!validate()) return;\n        try {\n            const response = await fetch(\n                `http://localhost:8000/scripts/edit/${script.id}`,\n                {\n                    method: \"PUT\",\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify(script)\n                }\n            );\n            navigate(\"/scripts\");\n        } catch (error) {\n            console.error(error.message);\n        }\n    };\n\n    useEffect(() => {\n        setScript({\n            ...script,\n            tags: tags,\n        });\n    }, [tags]);\n\n    return (\n        <form>\n            <div className=\"m-6 mb-0 bg-white rounded-lg border dark:border-gray-700 dark:bg-gray-800\">\n                <h5 className=\"m-3 text-2xl font-semibold tracking-tight text-gray-900 dark:text-white\">Edit Script</h5>\n            </div>\n            <div className=\"p-6\">\n                <div className=\"mb-4\">\n                    <label className=\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\">Title</label>\n                    <input type=\"text\" name=\"title\" value={script.title || \"\"} onChange={inputChange} className=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\" required />\n                </div>\n                <div className=\"mb-4\">\n                    <label className=\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\">Description</label>\n                    <input type=\"text\" name=\"description\" value={script.description || \"\"} onChange={inputChange} className=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\" required />\n                </div>\n                <div className=\"mb-4\">\n                    <label className=\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\">Timeline</label>\n                    <input type=\"date\" name=\"timeline\" value={script.timeline || \"\"} onChange={inputChange} className=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\" required />\n                </div>\n                <div className=\"mb-4\">\n                    <label className=\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-300\">Tags (optional)</label>\n                    <input type=\"text\" name=\"tags\" value={tagsInput || \"\"} onChange={tagsInputChange} onKeyDown={handleKeyDown} className=\"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\" required />\n                    <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">Click 'Enter' to add tags.</p>\n                    {tags.map((tag) => (\n                        <Tag key={tag} value={tag} onDelete={deleteTag} />\n                    ))}\n                </div>\n                <div>\n                    <label className=\"block mb-2 text-sm font-medium text-gray-900 dark:text-gray-400\">Script</label>\n                    <textarea id=\"scriptBody\" type=\"text\" name=\"body\" value={script.body} onChange={inputChange} rows={4} className=\"block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500\" placeholder=\"Write your script here...\" required />\n                </div>\n                {fieldNames.map((field) => (\n                    <button key={field} onClick={handleField} type=\"button\" className=\"mt-2 mr-2 inline-flex items-center bg-blue-100 hover:bg-blue-200 text-blue-800 text-sm font-medium px-1.5 py-0.5 rounded dark:bg-blue-200 dark:text-blue-800 dark:hover:bg-blue-300\">\n                        {field}\n                    </button>\n                ))}\n            </div>\n\n            <div className=\"pl-6 pb-6\">\n                <button type=\"button\" onClick={onSubmit} className=\"text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800\">Save</button>\n                <Link to=\"/scripts\">\n                    <button type=\"reset\" className=\"absolute right-6 text-white bg-red-700 hover:bg-red-800 focus:ring-4 focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900\">Cancel</button>\n                </Link>\n            </div>\n        </form>\n    );\n}\n\nexport default EditScript;\n"]},"metadata":{},"sourceType":"module"}